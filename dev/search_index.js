var documenterSearchIndex = {"docs":
[{"location":"api/#API-Reference","page":"API Reference","title":"API Reference","text":"","category":"section"},{"location":"api/#WiNDCRegional.State","page":"API Reference","title":"WiNDCRegional.State","text":"State\n\nThe primary container for state data tables. There are three fields, all dataframes:\n\ndata: The main data table.\nsets: The sets table, describing the different sets used in the model.\nelements: The elements table, describing the different elements in the model.\n\n\n\n\n\n","category":"type"},{"location":"api/#WiNDCRegional.absorption-Tuple{WiNDCRegional.AbstractRegionalTable}","page":"API Reference","title":"WiNDCRegional.absorption","text":"absorption(\n    state_table::AbstractRegionalTable; \n    column::Symbol = :value, \n    output::Symbol = :value\n)\n\nCalculate the absorption for each commodity in each region. The absorption is  defined as the sum of:\n\nIntermediate_Demand\nOther_Final_Demand\n\nNote that absorption is negative.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.adjust_by_absorption-Tuple{State}","page":"API Reference","title":"WiNDCRegional.adjust_by_absorption","text":"adjust_by_absorption(\n    state_table::State,    \n)\n\nAdjust state-level tables by absorption-related components, including:\n\nReexports\nExports\nHousehold Supply\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.balance_of_payments-Tuple{WiNDCRegional.AbstractRegionalTable}","page":"API Reference","title":"WiNDCRegional.balance_of_payments","text":"balance_of_payments(\n    state_table::AbstractRegionalTable; \n    column::Symbol = :value, \n    output::Symbol = :value\n)\n\nCalculate the balance of payments for each commodity in each region. The balance of payments is defined as the sum of:\n\nImports\nExports\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.create_reexports-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.create_reexports","text":"create_reexports(\n    state_table::State,\n    summary::National,\n    raw_data::Dict;\n)\n\nReexports are defined as the negative portion of the difference between total  supply and exports.\n\nDepends On\n\nWiNDCRegional.total_supply\nExports\n\nAdded Parameters\n\nReexport with element reexport\n\nAdded Sets\n\nreexport with element reexport in domain col\n\nAggregate Parameters\n\nAdd reexport to Use parameter.\n\nProcess\n\nReexports occur when total supply is less than exports. Calculate reexports as the negative portion of the difference between total supply and exports.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.create_regional_demand-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.create_regional_demand","text":"create_regional_demand(\n        state_table::State,\n        summary::National,\n        raw_data::Dict;\n    )\n\nCreate regional demand (local + national) based on regional purchase coefficients.\n\nRaw Data\n\nrpc - Regional purchase coefficients loaded using    WiNDCRegional.load_regional_purchase_coefficients.\n\nDepends On\n\nWiNDCRegional.absorption\nWiNDCRegional.total_supply\n\nAdded Parameters\n\nLocal_Demand with element local_demand\nNational_Demand with element national_demand\n\nAdded Sets\n\nlocal_demand with element local_demand in domain col\nnational_demand with element national_demand in domain col\n\nAggregate Parameters\n\nAdd local_demand and national_demand to Supply parameter.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.create_regional_margin_supply-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.create_regional_margin_supply","text":"create_regional_margin_supply(\n    state_table::State,\n    summary::National,\n    raw_data::Dict;\n)\n\nRaw Data\n\nrpc - Regional purchase coefficients loaded using    WiNDCRegional.load_regional_purchase_coefficients.\n\nAdded Parameters\n\nLocal_Margin_Supply with element local_margin_supply\nNational_Margin_Supply with element region_margin_supply\nMargin_Supply with elements local_margin_supply and region_margin_supply\n\nAdded Sets\n\nlocal_margin_supply with element local_margin_supply in domain parameter\nnational_margin_supply with element national_margin_supply in domain parameter\n\nAggregate Parameters\n\nAdd local_margin_supply and national_margin_supply to Margin_Supply and Use  parameters.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.create_state_table-Tuple{WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.create_state_table","text":"create_state_table(\n    summary::National,\n    regional_info::Dict,\n)\n\nDisaggregate the US WiNDCNational summary-level data into a state-level table,  using raw data files located in data_directory. The disaggregation is performed  through a sequence of functions, each disaggregating a specific component of the  national summary.\n\nReturns a balanced WiNDCRegional State table.\n\nRequired Arguments\n\nsummary::National: The national summary WiNDCNational table.\nregional_info::Dict: The full contents of the regional.yaml file, loaded    as a dictionary.\n\nDisaggregation Steps\n\nThe disaggregation is performed through the following steps:\n\nWiNDCRegional.initialize_table\nWiNDCRegional.disaggregate_intermediate\nWiNDCRegional.disaggregate_labor_capital\nWiNDCRegional.disaggregate_output_tax\nWiNDCRegional.disaggregate_investment_final_demand\nWiNDCRegional.disaggregate_personal_consumption\nWiNDCRegional.disaggregate_household_supply\nWiNDCRegional.disaggregate_government_final_demand\nWiNDCRegional.disaggregate_foreign_exports\nWiNDCRegional.create_reexports\nWiNDCRegional.disaggregate_foreign_imports\nWiNDCRegional.disaggregate_margin_demand\nWiNDCRegional.disaggregate_duty\nWiNDCRegional.disaggregate_tax\nWiNDCRegional.create_regional_demand\nWiNDCRegional.create_regional_margin_supply\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_by_shares-Tuple{WiNDCNational.National, DataFrames.DataFrame, Vector{Symbol}}","page":"API Reference","title":"WiNDCRegional.disaggregate_by_shares","text":"disaggregate_by_shares(\n        summary::WiNDCNational.National,\n        disaggregate::DataFrame,\n        parameter::Vector{Symbol};\n        domain = :commodity,\n    )\n\ndisaggregate_by_shares(\n        summary::WiNDCNational.National,\n        disaggregate::DataFrame,\n        parameter::Symbol;\n        domain = :commodity,\n    )\n\nDisaggregate the national-level parameter from the summary data to the  regional level using shares from the disaggregate DataFrame.\n\nThe disaggregate DataFrame should contain the columns:\n\n:year: The year of the data.\n:state: The state identifier.\n:naics: The industry code.\n:value: The share value for disaggregation.\n:name: The name of the industry or sector.\n\nThe function returns a DataFrame with the disaggregated values for each state  and industry code.\n\nThis function will identify values in summary that are not present in disaggregate and will disaggreagte by equal shares. \n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_duty-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_duty","text":"disaggregate_duty(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the duty from the national summary into state-level using national level duty rates and total imports by state.\n\nDepends On\n\nImports\n\nAdded Parameters\n\nDuty with element duty\n\nAggregate Parameters\n\nAdd duty to Supply parameter.\n\nProcess\n\nAssume equal duty rates across all states. Calculate state-level duty by multiplying state-level imports by the national duty rate.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_foreign_exports-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_foreign_exports","text":"disaggregate_foreign_exports(\n        state_table::State,    \n        summary::National,\n        raw_data::Dict;\n    )\n\nDisaggregate the foreign exports from the national summary into state-level using BEA GSP data and trade shares.\n\nRaw Data\n\ngdp - State GDP data (SAGDP2) loaded using WiNDCRegional.load_state_gdp.\ntrade_shares - Trade shares data loaded using    WiNDCRegional.load_trade_shares.\n\nAdded Parameters\n\nExport with element export\n\nAggregate Parameters\n\nAdd export to Use, Final_Demand, and Export parameters.\n\nProcess\n\nUse trade shares data to disaggregate exports where available. For commodities without trade share data, use state GDP data to disaggregate exports by shares.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_foreign_imports-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_foreign_imports","text":"disaggregate_foreign_imports(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the foreign imports from the national summary into state-level using absorption.\n\nDepends On\n\nabsorption\n\nAdded Parameters\n\nImport with element import\n\nAggregate Parameters\n\nAdd import to Supply parameter.\n\nProcess\n\nUse the WiNDCRegional.disaggregate_by_shares function on the domain commodity to disaggregate imports using absorption data as shares.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_government_final_demand-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_government_final_demand","text":"disaggregate_government_final_demand(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the government final demand from the national summary into state-level using Census SGF data. Also aggregates all government final demand to a single  element govern, updates the elements table accordingly.\n\nRaw Data\n\nsgf - State Government Finances data loaded using    WiNDCRegional.load_state_finances.\n\nAdded Parameters\n\nGovernment_Final_Demand with element government_final_demand\n\nAdded Sets\n\ngovernment_final_demand with element govern in domain col\n\nAggregate Parameters\n\nAdd government_final_demand to Use, Other_Final_Demand, and Final_Demand parameters.\n\nProcess\n\nUse the WiNDCRegional.disaggregate_by_shares function on the domain commodity to disaggregate government final demand using Census SGF data as shares.\n\nThe data is then grouped by row, year, parameter, and region to aggregate all summary-level government final demand elements into a single element govern.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_household_supply-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_household_supply","text":"disaggregate_household_supply(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the household supply from the national summary into state-level using BEA PCE data.\n\nRaw Data\n\npce - Personal Consumption Expenditure data loaded using    WiNDCRegional.load_pce_data.\n\nAdded Parameters\n\nHousehold_Supply with element household_supply\n\nAggregate Parameters\n\nAdd household_supply to Supply parameters.\n\nProcess\n\nUse the WiNDCRegional.disaggregate_by_shares function on the domain commodity to disaggregate household supply using BEA PCE data as shares.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_intermediate-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_intermediate","text":"disaggregate_intermediate(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the intermediate demand and supply from the national summary into  state-level using BEA GSP data.\n\nRaw Data\n\ngdp - State GDP data (SAGDP2) loaded using WiNDCRegional.load_state_gdp.\n\nAdded Parameters\n\nIntermediate_Demand with element intermediate_demand\nIntermediate_Supply with element intermediate_supply\n\nAggregate Parameters\n\nAdd intermediate_demand to Use parameter and intermediate_supply to Supply parameter.\n\nProcess\n\nUse the WiNDCRegional.disaggregate_by_shares function on the domain  sector to disaggregate intermediate demand and supply using state GDP data as  shares.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_investment_final_demand-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_investment_final_demand","text":"disaggregate_investement_final_demand(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the investment final demand from the national summary into state-level using BEA GSP data. Also aggregates all investment final demand to a single  element invest, updates the elements table accordingly.\n\nRaw Data\n\ngdp - State GDP data (SAGDP2) loaded using WiNDCRegional.load_state_gdp.\n\nAdded Parameters\n\nInvestment_Final_Demand with element investment_final_demand\n\nAdded Sets\n\ninvestment_final_demand with element invest in domain col\n\nAggregate Parameters\n\nAdd investment_final_demand to Use, Other_Final_Demand, and Final_Demand parameters.\n\nProcess\n\nUse the WiNDCRegional.disaggregate_by_shares function on the domain commodity to disaggregate investment final demand using state GDP data as shares.\n\nThe data is then grouped by row, year, parameter, and region to aggregate all summary-level investment final demand elements into a single element invest.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_labor_capital-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_labor_capital","text":"disaggregate_labor_capital(\n        state_table::State,    \n        summary::National,\n        raw_data::Dict;\n    )\n\nDisaggregate the labor and capital demand from the national summary into state-level using BEA GSP data.\n\nRaw Data\n\nAll data is loaded using WiNDCRegional.load_state_gdp.\n\ngdp - State GDP data (SAGDP2) \nlabor - State labor data (SAGDP4)\ncapital - State capital data (SAGDP7)\ntax - State tax data (SAGDP6)\nsubsidy - State subsidy data (SAGDP5)\n\nAdded Parameters\n\nLabor_Demand with element labor_demand\nCapital_Demand with element capital_demand\n\nAggregate Parameters\n\nAdd labor_demand and capital_demand to Value_Added and Use parameters.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_margin_demand-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_margin_demand","text":"disaggregate_margin_demand(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the margin demand from the national summary into state-level using absorption.\n\nDepends On\n\n- [`absorption`](@ref)\n\nAdded Parameters\n\nMargin_Demand with element margin_demand\n\nAggregate Parameters\n\nAdd margin_demand to Supply parameter.\n\nProcess\n\nUse the WiNDCRegional.disaggregate_by_shares function on the domain commodity to disaggregate margin demand using absorption data as shares.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_output_tax-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_output_tax","text":"disaggregate_output_tax(\n    state_table::State,    \n    summary::National,\n    data_directory::String\n)\n\nDisaggregate the output tax from the national summary into state-level using  national level tax rates and total output by state.\n\nDepends On\n\nIntermediate Supply\nSummary output tax rate\n\nAdded Parameters\n\nOutput_Tax with element output_tax\n\nAggregate Parameters\n\nAdd output_tax to Use set.\n\nProcess\n\nAssume equal tax rates across all states. Calculate state-level output tax by multiplying state-level intermediate supply by the national output tax rate.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_personal_consumption-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_personal_consumption","text":"disaggregate_personal_consumption(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the personal consumption expenditure by shares from the national summary into state-level using BEA PCE data.\n\nRaw Data\n\npce - Personal Consumption Expenditure data loaded using    WiNDCRegional.load_pce_data.\n\nAdded Parameters\n\nPersonal_Consumption with element personal_consumption\n\nAggregate Parameters\n\nAdd personal_consumption to Use, Other_Final_Demand, and Final_Demand parameters.\n\nProcess\n\nUse the WiNDCRegional.disaggregate_by_shares function on the domain commodity to disaggregate personal consumption using BEA PCE data as shares.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.disaggregate_tax-Tuple{State, WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.disaggregate_tax","text":"disaggregate_tax(\n    state_table::State,    \n    summary::National,\n    raw_data::Dict;\n)\n\nDisaggregate the tax from the national summary into state-level using BEA GSP data. The resulting tax will be inclusive of subsidies, which is a change  from the summary level data.\n\nDepends On\n\nWiNDCRegional.absorption\nSummary absorption tax rate\n\nAdded Parameters\n\nTax with element tax\n\nAggregate Parameters\n\nAdd tax to Supply parameters.\n\nProcess\n\nThe absorption tax rate is calculated inclusive of subisidies at the national level. Assume equal tax rates across all states. The state-level tax is calculated by multiplying the state-level absorption by the national absorption tax rate.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.extend_data-Tuple{DataFrames.DataFrame, Symbol, Any, Any}","page":"API Reference","title":"WiNDCRegional.extend_data","text":"extend_data(X::DataFrame, column::Symbol, old_value, new_value)\n\nExtend data from X by copying rows where column equals old_value to new  rows where column equals new_value. This is used, for example, the maximum year is 2023, but we need to extend to 2024 by copying 2023 data. \n\nThe function takes four arguments:\n\nX::DataFrame: The dataframe to append.\ncolumn::Symbol: The column to search for the old value.\nexisiting_data: The base data to use for the new values\nnew_data: The name of the new data.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.initialize_table-Tuple{WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.initialize_table","text":"initialize_table(summary::National)\n\nCreate an empty State table structure based on the sets and elements of the  provided National summary. \n\nAdd one set, State, containing all US states. The states are loaded using the  WiNDCRegional.load_state_fips function. \n\nEach disaggregation function will add new parameters and elements as needed.\n\nSets with Elements Preserved\n\ncapital_demand\ncommodity\nduty\nexport\nimport\nlabor_demand\nmargin\noutput_tax\npersonal_consumption\nsector\ntax\ntrade\ntransport\nyear\n\nAggregate Parameters\n\nThese parameters are kept, but all elements are removed. \n\nOther_Final_Demand\nUse\nSupply\nFinal_Demand\nValue_Added\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.labor_shares-Tuple{WiNDCNational.National, Dict}","page":"API Reference","title":"WiNDCRegional.labor_shares","text":"labor_shares(\n    summary::National,\n    raw_data::Dict;\n)\n\nCompute the share of total value added (labor + capital) attributed to labor for each region, sector, and year. \n\nReturns a DataFrame with columns: year, region, col (sector), and value (labor share).\n\nRequired Arguments\n\nsummary::National: A National object containing the national summary data.\nraw_data::Dict: A dictionary containing the raw data DataFrames.\n\nRaw Data Used\n\nAll data is loaded with load_state_gdp, the dictionary should contain the following keys:\n\n:gdp - SAGDP2\n:labor - SAGDP4\n:capital - SAGDP7\n:tax - SAGDP6\n:subsidy - SAGDP5\n\nMotivation\n\nThe captial data provided by the BEA has unavoidable negative values for some  years, sectors, and regions. To address this, we compute labor shares by reconciling  the reported GDP data with GDP computed from GSP components (labor, capital, tax,  subsidy). We then use a least squares optimization approach to estimate labor  shares that are consistent with both the national-level labor shares and the regional GDP data.\n\nData Source\n\nThis data can be downloaded from  the BEA website, select Gross Domestic Product (GDP) by State and download the SAGDP data.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_faf_base-Tuple{String, DataFrames.DataFrame, DataFrames.DataFrame}","page":"API Reference","title":"WiNDCRegional.load_faf_base","text":"load_faf_base(\n    path::String,\n    state_fips::DataFrame,\n    faf_map::DataFrame;\n    cols_to_keep = [\n        :fr_orig,\n        :dms_origst,\n        :dms_destst,\n        :fr_dest,\n        :trade_type,\n        :sctg2,\n    ],\n    regex_cols_to_keep = r\"^value_(\\d{4})$\",\n    max_year = 2023,\n)\n\nThe FAF provides two files, one with data from 2017 onward, and one with  reprocessed data from 1997-2012. This function provides the common loading logic.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_faf_data-Tuple{String, String}","page":"API Reference","title":"WiNDCRegional.load_faf_data","text":"load_faf_data(\n    state_path::String,\n    reprocessed_path::String,\n    state_fips::DataFrame,\n    faf_map::DataFrame;\n    cols_to_keep = [\n        :fr_orig,\n        :dms_origst,\n        :dms_destst,\n        :fr_dest,\n        :trade_type,\n        :sctg2,\n    ],\n    regex_cols_to_keep = r\"^value_(\\d{4})$\",\n    max_year = 2023,\n)\n\nLoad the two necessary FAF files and aggregate to demand. The returned DataFrame has columns:\n\ndestination - FIPS code of destination state\nyear - Year of the trade flow\nnaics - NAICS code of the traded good\nlocal - And indicator on if the flow is local (within state) or national (between states)\nvalue - Value of the traded good in millions of USD\n\nThe returned DataFrame has data for all years 1997 to max_year. The reprocessed data only has data on a five year basis (1997, 2002, 2007, 2012), the intermediate  years uses the data from the closest available year.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_faf_map-Tuple{}","page":"API Reference","title":"WiNDCRegional.load_faf_map","text":"load_faf_map(; \n        path = joinpath(@__DIR__,  \"data\", \"faf_map.csv\"),\n        keep_cols::Vector{Symbol} = [:sctg2, :naics]\n    )\n\nLoad the FAF to NAICS mapping file. Optionally keep only a subset of columns, by specifying the keep_cols argument. \n\nReturns a DataFrame with the specified columns. The naics column is converted to a Symbol.\n\nOptional Arguments\n\npath::String: Path to the FAF mapping CSV file.\nkeep_cols::Vector{Symbol}: Columns to keep from the CSV file. Default is \n\n[:sctg2, :naics].\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_industry_codes-Tuple{}","page":"API Reference","title":"WiNDCRegional.load_industry_codes","text":"load_industry_codes(;\n        path = joinpath(@__DIR__, \"data\", \"industry_codes.csv\"),\n    )\n\nLoad a CSV file containing industry codes. The default path is set to \"data/industry_codes.csv\" relative to this file's directory.\n\nReturns a DataFrame with two columns, LineCode and naics. The naics column  is converted to a Symbol and and missing values are dropped.\n\nOptional Arguments\n\npath::String: Path to the industry codes CSV file.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_map_data-Tuple{Dict}","page":"API Reference","title":"WiNDCRegional.load_map_data","text":"load_map_data(map_dictionary::Dict)\n\nLoad map data specified in the metadata:maps section of the regional.yaml file. Returns a dictionary of DataFrames, with keys corresponding to the map types.\n\nIf the paths are not speicifed in WiNDCRegional.load_regional_yaml, the  default maps will be loaded.\n\nRequired Arguments\n\nmap_dictionary::Dict: A dictionary with keys the name of the map and values the    path to the map data file. If the value is nothing, the default map will be loaded.\n\nDefault Loading Functions\n\nstate_map - WiNDCRegional.load_state_fips\ngdp_map - WiNDCRegional.load_industry_codes\npce_map - WiNDCRegional.load_pce_map\nsgf_map - WiNDCRegional.load_sgf_map\nsgf_states_map - WiNDCRegional.load_sgf_states\ntrade_map - WiNDCRegional.load_usatrade_map\nfaf_map - WiNDCRegional.load_faf_map\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_pce_data-Tuple{String, String}","page":"API Reference","title":"WiNDCRegional.load_pce_data","text":"function load_pce_data(\n    path::String,\n    name::String;\n    state_fips::DataFrame = load_state_fips(),\n    pce_map::DataFrame = load_pce_map(),\n)\n\nLoad the Personal Consumption Expenditures (PCE) data.\n\nRequired Arguments\n\npath::String: Path to the PCE CSV file.\nname::String: Name to assign to the loaded data, e.g. the state name.\n\nOptional Arguments\n\nstate_fips::DataFrame: load_state_fips DataFrame mapping state FIPS codes to state abbreviations.\npce_map::DataFrame: load_pce_map DataFrame mapping PCE LineCodes to NAICS codes.\n\nData Source\n\nThis data can be downloaded from  the BEA website, select  Personal Consumption Expenditures (PCE) by State and download the PCE data.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_pce_map-Tuple{}","page":"API Reference","title":"WiNDCRegional.load_pce_map","text":"load_pce_map(;\n        path = joinpath(@__DIR__, \"data\", \"pce_map.csv\"),\n    )\n\nLoad the PCE to NAICS mapping file. The default path is set to data/pce_map.csv relative to this file's directory.\n\nReturns a DataFrame with four columns: Line Code, description_pcs, naics,  and description. It is recommended you mirror this structure if you provide  your own mapping file.\n\nOptional Arguments\n\npath::String: Path to the PCE mapping CSV file.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_raw_data-Tuple{WiNDCNational.National, Dict, String, Dict{Symbol, DataFrames.DataFrame}}","page":"API Reference","title":"WiNDCRegional.load_raw_data","text":"load_raw_data(\n        summary::National,\n        data_info::Dict, \n        data_directory::String, \n        maps::Dict{Symbol, DataFrame}\n    )\n\nLoad data files specified in regional.yaml needed for disaggregation of the US WiNDCNational summary into state-level WiNDCRegional table.\n\nReturns a dictionary of DataFrames, with keys corresponding to key in the data section of regional.yaml.\n\nRequired Arguments\n\nsummary::National: The national summary WiNDCNational table.\ndata_info::Dict: The data section of the regional.yaml file.\ndata_directory::String: The base directory where data files are located. This    is specified in the metadata:data_directory field of regional.yaml.\nmaps::Dict{Symbol, DataFrame}: A dictionary of mapping DataFrames loaded using   WiNDCRegional.load_map_data.\n\nData Loading Functions\n\nstate_gdp - All values - WiNDCRegional.load_state_gdp\npce - WiNDCRegional.load_pce_data\nsgf - WiNDCRegional.load_state_finances\ntrade_shares\nexports and imports - WiNDCRegional.load_usa_raw_trade_data\nag_time_series - WiNDCRegional.load_usda_agricultural_flow\ntrade shares - WiNDCRegional.load_trade_shares\nrpc - WiNDCRegional.load_regional_purchase_coefficients\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_regional_purchase_coefficients-Tuple{WiNDCNational.National, String, String}","page":"API Reference","title":"WiNDCRegional.load_regional_purchase_coefficients","text":"load_regional_purchase_coefficients(\n    summary::WiNDCNational.National,\n    state_path::String,\n    reprocessed_path::String,\n    data_directory::String;\n    adjusted_demand = Dict{Symbol, Float64} = Dict(),\n    state_fips::DataFrame = load_state_fips(),\n    faf_map::DataFrame = load_faf_map(),\n    cols_to_keep = [\n        :fr_orig,\n        :dms_origst,\n        :dms_destst,\n        :fr_dest,\n        :trade_type,\n        :sctg2,\n    ],\n    regex_cols_to_keep = r\"^value_(\\d{4})$\",\n    max_year = elements(summary, :year) |> x->maximum(x[!,:name]),\n    )\n\nThe regional purchase coefficients are used to determine the mixture of domestic  vs. national demand in the absorption market. The coefficients are calculated based on the FAF data and the commodity data. The returned DataFrame has columns:\n\nstate - FIPS code of the state\nyear - Year of the coefficient\nnaics - NAICS code of the good\nrpc - Regional purchase coefficient, between 0 and 1\n\nThe computation has several steps:\n\nLoad the FAF data using load_faf_data to get trade flows.\nIdentify non-trade goods, which are goods that do not appear in the FAF data. Pin the RPC to be the average over the traded goods.\nCompute the RPC as local / (local + national)\nApply any adjusted demand values provided in the adjusted_demand dictionary.\n\nArguments\n\nsummary: The national summary data, used to identify non-trade goods.\nstate_path: Path to the FAF data file for state-level data (2017 onward).\nreprocessed_path: Path to the FAF data file for reprocessed data (1997   to 2012).\ndata_directory: Base directory for the data files.\n\nOptional Arguments\n\nadjusted_demand: A dictionary mapping NAICS codes to adjusted RPC values. If a NAICS code is present in this dictionary, the corresponding RPC value will be used instead of the computed value. Default is an empty dictionary.\nstate_fips: DataFrame containing state FIPS codes. Defaults to loading from common files.\nfaf_map: DataFrame mapping FAF SCTG codes to NAICS codes. Defaults to loading from common files.\ncols_to_keep: Columns to keep from the FAF data. Defaults to a predefined list of columns.\nregex_cols_to_keep: Regular expression to match columns to keep from the FAF data. Defaults to a predefined regular expression.\nmax_year: Maximum year to include in the data. Defaults to the maximum year in the summary data.\n\nData Source\n\nThe Frieght Analysis Framework (FAF) data can be  downloaded from the BTS website. We use two data files:\n\nThe regional database, or FAF5.7.1_State.csv as of December 2025, which \n\ncontains data from 2017 onward.\n\nThe reprocessed data file, or FAF5.7.1_Reprocessed.csv as of December 2025,\n\nwhich contains data from 1997 to 2012 on a five-year basis.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_regional_yaml-Tuple{String}","page":"API Reference","title":"WiNDCRegional.load_regional_yaml","text":"load_regional_yaml(path::String)\n\nLoad a YAML file containing regional configuration data. Ensure the file is  formatted correctly with proper field names and structure.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_sgf_map-Tuple{}","page":"API Reference","title":"WiNDCRegional.load_sgf_map","text":"load_sgf_map(;\n        path = joinpath(@__DIR__, \"data\", \"sgf_map.csv\"),\n        keep_cols::Vector{Symbol} = [:naics, :sgf_code]\n    )\n\nLoad the SGF to NAICS mapping file. Optionally keep only a subset of columns, by specifying the keep_cols argument.\n\nReturns a DataFrame with the specified columns. All data is returned as Strings.\n\nOptional Arguments\n\npath::String: Path to the SGF mapping CSV file.\nkeep_cols::Vector{Symbol}: Columns to keep from the CSV file. Default is \n\n[:naics, :sgf_code].\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_sgf_states-Tuple{}","page":"API Reference","title":"WiNDCRegional.load_sgf_states","text":"load_sgf_states(;\n        path = joinpath(@__DIR__, \"data\", \"sgf_states.csv\"),\n    )\n\nLoad the SGF states mapping file. The default path is set to data/sgf_states.csv relative to this file's directory.\n\nReturns a DataFrame with two columns: code and state. Both columns are converted to Strings.\n\nOptional Arguments\n\npath::String: Path to the SGF states CSV file.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_state_finances-Tuple{Regex, String}","page":"API Reference","title":"WiNDCRegional.load_state_finances","text":"load_state_finances(\n    file_pattern::Regex,\n    directory_path::String;\n    sgf_map::DataFrame = WiNDCRegional.load_sgf_map(),\n    sgf_states::DataFrame = WiNDCRegional.load_sgf_states(),\n    replacement_data::Dict = Dict()\n    )\n\nLoad state government finance data that matches the file pattern in the given directory path. \n\nRequired Arguments\n\nfile_pattern::Regex: A regex pattern to match the filenames, typically of the    form ^(?<year>\\d{2})(state|data)35.txt$\ndirectory_path::String: Location of the data files.\n\nOptional Arguments\n\nsgf_map::DataFrame: A dataframe mapping SGF codes to NAICS codes. Default is   WiNDCRegional.load_sgf_map().\nsgf_states::DataFrame: A dataframe mapping FIPS codes to state names. Default is   WiNDCRegional.load_sgf_states().\nreplacement_data::Dict: A dictionary of replacement data to append to the   dataframe. The keys are column names, and the values are dictionaries   mapping new data names to existing data names. The replacement is done using   WiNDCRegional.extend_data.\n\nData Source\n\nThe data can be downloaded from Census.gob. We need this data from 1997 onward. There does not appear to be a bulk download option, so each file must be downloaded manually.\n\nThese files are heavily encoded TXT files. For reference, here are the first few lines of the 2023 data file (23state35.txt):\n\n \n0000000000000019U 1089056745232324\n0000000000000029U 95934926232324\n0000000000000039U 109916472232324\n0000000000000049U 1077543532232324\n0000000000000052T 7567094232324\n0000000000000053T 5175382232324\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_state_fips-Tuple{}","page":"API Reference","title":"WiNDCRegional.load_state_fips","text":"load_state_fips(;\n        path = joinpath(@__DIR__, \"data\", \"state_fips.csv\"),\n        cols_to_keep = [:fips, :state]\n    )\n\nLoad a CSV file containing state FIPS codes and state names. The default path is set to data/state_fips.csv relative to this file's directory. You can specify which columns to keep using the cols_to_keep argument.\n\nReturns a DataFrame with the specified columns as Strings.\n\nOptional Arguments\n\npath::String: Path to the state FIPS CSV file.\ncols_to_keep::Vector{Symbol}: Columns to keep from the CSV file. Default is [:fips, :state].\n\nIt is recommended to keep the columns :fips and :state for proper mapping.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_state_gdp-Tuple{String, String}","page":"API Reference","title":"WiNDCRegional.load_state_gdp","text":"load_state_gdp(\n    path::String, \n    name::String;\n    state_fips::DataFrame = load_state_fips(),\n    industry_codes::DataFrame = load_industry_codes(),\n    )\n\nLoad SAGDP data. \n\nRequired Arguments\n\npath::String: Path to the SAGDP CSV file.\nname::String: Name to assign to the loaded data, e.g. gdp.\n\nOptional Arguments\n\nstate_fips::DataFrame: DataFrame mapping state FIPS codes to state abbreviations.\nindustry_codes::DataFrame: DataFrame mapping BEA industry codes to NAICS codes.\n\nBy default, we use the default maps provided by load_state_fips() and load_industry_codes(). However, any mapping DataFrame with the same structure can be provided.\n\nData Source\n\nThis data can be downloaded from  the BEA website, select Gross Domestic Product (GDP) by State and download the SAGDP data.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_trade_shares-Tuple{DataFrames.DataFrame, DataFrames.DataFrame, DataFrames.DataFrame}","page":"API Reference","title":"WiNDCRegional.load_trade_shares","text":"load_trade_shares(\n    exports::DataFrame,\n    imports::DataFrame,\n    usda_agricultural_flow::DataFrame;\n    agricultural_code = Symbol(\"111CA\"),\n    base_year::Int = 1997\n)\n\nUse exports, imports and usda agricultural flow data to calculate the foreign flow of goods.\n\nRequired Arguments\n\nexports::DataFrame: Export data from load_usa_raw_trade_data.\nimports::DataFrame: Import data from load_usa_raw_trade_data.\nusda_agricultural_flow::DataFrame: Agricultural flow data from    load_usda_agricultural_flow.\n\nOptional Arguments\n\nagricultural_code::Symbol: The NAICS code for the agricultural commodity.    Default is :111CA.\nbase_year::Int: The base year for backfilling missing years. Default is    1997, the first year of summary data.\n\nData Source\n\nThere are two sources for this input data. The first is the  USA Trade Online portal. This requires a log-in.  For both Imports and Exports we want NAICS data. When selecting data, we want  every state (this is different that All States), the most disaggregated  commodities (third level), and for Exports we want World Total and for Imports  we want both World Total and Canada in the Countries column.\n\nThe second source is the file Commodity_detail_by_state_cy.xlsx.  This is a very fragile link that may change over time. If you find this link is broken, raise an issue on the WiNDCRegional GitHub repository.\n\nLoading Process\n\nFirst we calculate the trade shares for each state, commodity, flow, and year. This is given by:\n\nfracVsum_rm state V\n\nThere are years with no trade data for certain commodities. We use the yearly region share to set a default value for each state and commodity/flow pair. The yearly region share is defined by:\n\nfracsum_rm year Vsum_rm stateleft(sum_rm year Vright)\n\nThese two values are combined such that if there is no trade data for a given year, the default value is used instead. We then remove all values where with naics code agricultural_code and flow exports from the data, and append the USDA agricultural flow data.\n\nFinally, we back fill missing years for 1997-2001 using the next available year's data.  Note that the minimum year for each state/commodity/flow combination is used to  determine which years need to be back filled, with a maximum year of 2002.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_usa_raw_trade_data-Tuple{String, String}","page":"API Reference","title":"WiNDCRegional.load_usa_raw_trade_data","text":"load_usa_raw_trade_data(\n    path::String,\n    flow::String;\n    value_col::Symbol = flow == \"exports\" ? :Total_Exports_Value_US_ : :Customs_Value_Gen_US_,\n    state_fips::DataFrame = load_state_fips(),\n    usatrade_map::DataFrame = load_usatrade_map(),\n)\n\nLoad data exported from the USA Trade online portal. The input flow should be  either \"exports\" or \"imports\".\n\nThe value_col should be either :Total_Exports_Value_US_ or :Customs_Value_Gen_US_  depending on whether you are loading export or import data.\n\nThis will return a normalized DataFrame with columns :year, :state, :naics,  :value, and :flow.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_usatrade_map-Tuple{}","page":"API Reference","title":"WiNDCRegional.load_usatrade_map","text":"load_usatrade_map(;\n        path = joinpath(@__DIR__, \"data\", \"usatrade_map.csv\"),\n        keep_cols::Vector{Symbol} = [:naics, :naics4]\n    )\n\nLoad the USA Trade to NAICS mapping file. Optionally keep only a subset of columns, by specifying the keep_cols argument.\n\nReturns a DataFrame with the specified columns. The naics and naics4 columns are converted to Symbols.\n\nOptional Arguments\n\npath::String: Path to the USA Trade mapping CSV file.\nkeep_cols::Vector{Symbol}: Columns to keep from the CSV file. Default is \n\n[:naics, :naics4].\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.load_usda_agricultural_flow-Tuple{String, String, String}","page":"API Reference","title":"WiNDCRegional.load_usda_agricultural_flow","text":"load_usda_agricultural_flow(\n        path::String,\n        sheet::String,\n        range::String; \n        agriculture_code = Symbol(\"111CA\"),\n        flow::String = \"exports\"\n    )\n\nLoad additional agricultural trade flow data from USDA. This data is used to supplement the USA Trade data for the agricultural_code.\n\nReturns a DataFrame with columns :year, :state, :naics, :value, and :flow.\n\nRequired Arguments\n\npath::String: Path to the Excel file.\nsheet::String: Sheet name in the Excel file.\nrange::String: Cell range in the sheet to read.\n\nOptional Arguments\n\nagriculture_code::Symbol: The NAICS code for the agricultural commodity. Default is :111CA.\nflow::String: The trade flow type, either exports or imports. Default is exports.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.margin_balance-Tuple{WiNDCRegional.AbstractRegionalTable}","page":"API Reference","title":"WiNDCRegional.margin_balance","text":"margin_balance(\n    data::AbstractRegionalTable; \n    column::Symbol = :value, \n    output::Symbol = :value,\n    parameter::Symbol = :margin_balance,\n    minimal::Bool = true\n)\n\nCalculate the margin balance condition. For each margin, the margin  balance condition is defined as the sum of the following parameters:\n\nMargin_Supply\nMargin_Demand\n\nRequired Arguments\n\ndata::AbstractRegionalTable: The national data.\n\nKeyword Arguments\n\ncolumn::Symbol = :value: The column to be used for the calculation.\noutput::Symbol = :value: The name of the output column.\nparameter::Symbol =:margin_balance`: The name of the parameter column.\nminimal::Bool = true: Whether to return a minimal output. If true, only the    essential columns are returned: [:col, :year, :parameter, output]. \n\nOutput\n\nReturns a DataFrame with columns [:row, :col, :year, :parameter, output], where  output is the renamed column column. Note that :col is filled with :mb  and :parameter is filled with parameter.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.market_clearance-Tuple{WiNDCRegional.AbstractRegionalTable}","page":"API Reference","title":"WiNDCRegional.market_clearance","text":"market_clearance(\n    data::AbstractRegionalTable; \n    column::Symbol = :value, \n    output::Symbol = :value,\n    parameter::Symbol = :market_clearance,\n    minimal::Bool = true\n)\n\nCalculate the market clearance condition. For each commodity, the market  clearance condition is defined as the sum of the following parameters:\n\nIntermediate_Demand\nFinal_Demand\nIntermediate_Supply\nHousehold_Supply\nMargin_Supply\nMargin_Demand\nImports\nTax\nDuty\nSubsidies\n\nRequired Arguments\n\ndata::AbstractRegionalTable: The national data.\n\nKeyword Arguments\n\ncolumn::Symbol = :value: The column to be used for the calculation.\noutput::Symbol = :value: The name of the output column.\nparameter::Symbol =:market_clearance`: The name of the parameter column.\nminimal::Bool = true: Whether to return a minimal output. If true, only the    essential columns are returned: [:row, :year, :parameter, output]. \n\nOutput\n\nReturns a DataFrame with columns [:row, :col, :year, :parameter, output], where  output is the renamed column column. Note that :col is filled with :mc  and :parameter is filled with parameter.\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.parse_value_by_unit-Tuple{AbstractString, Real}","page":"API Reference","title":"WiNDCRegional.parse_value_by_unit","text":"parse_value_by_unit(unit::String, value::Real)\n\nWant values to be in billions of dollars\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.total_supply-Tuple{WiNDCRegional.AbstractRegionalTable}","page":"API Reference","title":"WiNDCRegional.total_supply","text":"total_supply(data::AbstractRegionalTable; column::Symbol = :value, output::Symbol = :value)\n\nCalculate the total supply for each commodity. The total supply is defined as the sum of:\n\nIntermediate_Supply\nHousehold_Supply\n\n\n\n\n\n","category":"method"},{"location":"api/#WiNDCRegional.zero_profit-Tuple{WiNDCRegional.AbstractRegionalTable}","page":"API Reference","title":"WiNDCRegional.zero_profit","text":"zero_profit(X::AbstractRegionalTable; column = :value, output = :value)\n\nCalculate the zero profit condition. For each sector, the zero profit  condition is defined as the sum of the following parameters:\n\nIntermediate_Demand\nIntermediate_Supply\nValue_Added\n\nRequired Arguments\n\ndata::AbstractRegionalTable: The national data.\n\nKeyword Arguments\n\ncolumn::Symbol = :value: The column to be used for the calculation.\noutput::Symbol = :value: The name of the output column.\nparameter::Symbol =:zero_profit`: The name of the parameter column.\nminimal::Bool = true: Whether to return a minimal output. If true, only the    essential columns are returned: [:row, :year, :parameter, output]. \n\nOutput\n\nReturns a DataFrame with columns [:row, :col, :year, :parameter, output], where  output is the renamed column column. Note that :col is filled with :zp  and :parameter is filled with parameter.\n\n\n\n\n\n","category":"method"},{"location":"#[WiNDCRegional](https://github.com/uw-windc/WiNDCRegional.jl)","page":"WiNDCRegional","title":"WiNDCRegional","text":"","category":"section"}]
}
